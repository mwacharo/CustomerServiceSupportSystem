import{A as I}from"./AppLayout-BlYOkN2W.js";import{s as R,i as o,o as c,c as p,w as a,b as e,f as u,e as f}from"./app-DLaO8MPJ.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";const S={components:{AppLayout:I},data(){return{users:[],ivrOptions:[],search:"",selectedReportType:null,selectedStatus:null,selectedAgent:null,startDate:null,endDate:null,menu1:!1,menu2:!1,reportTypes:["Call Summary Report","Agent Performance","Missed Calls","IVR Report","Airtime Report"],statusTypes:["NO_ANSWER","USER_BUSY","CALL_REJECTED","SUBSCRIBER_ABSENT","NORMAL_TEMPORARY_FAILURE","UNSPECIFIED","RECOVERY_ON_TIMER_EXPIRE","NORMAL_CLEARING","NO_USER_RESPONSE","UNALLOCATED_NUMBER"],reportData:[],headers:[]}},created(){this.fetchIvrOptions(),this.fetchUsers()},methods:{fetchUsers(){R.get("v1/users").then(l=>{this.users=l.data.map(i=>({...i,roles:i.roles&&i.roles.length?i.roles:[]}))}).catch(l=>console.error("API Error:",l))},fetchIvrOptions(){R.get("api/v1/ivr-options").then(r=>{this.ivrOptions=r.data.ivrOptions}).catch(r=>console.error("API Error:",r))},generateReport(){switch(this.selectedReportType){case"Call Summary Report":this.headers=[{title:"Agent",value:"agent"},{title:"Total Calls",value:"summary_call_completed"},{title:"Inbound Calls",value:"summary_inbound_call_completed"},{title:"Outbound Calls",value:"summary_outbound_call_completed"},{title:"Call Duration",value:"summary_call_duration"},{title:"Missed Calls",value:"summary_call_missed"},{title:"Rejected Incoming",value:"summary_rejected_incoming_calls"},{title:"User Busy Outgoing",value:"summary_user_busy_outgoing_calls"},{title:"Rejected Outgoing",value:"summary_rejected_outgoing_calls"}],this.fetchReportData("/api/v1/reports/call-summary");break;case"Agent Performance":this.headers=[{title:"Agent",value:"agent"},{title:"Calls Handled",value:"total_calls"},{title:"Avg Duration (min)",value:"avg_duration"}],this.fetchReportData("/api/v1/reports/call-summary");break;case"Missed Calls":this.headers=[{title:"Customer",value:"customer"},{title:"Missed Time",value:"time"},{title:"Callback Status",value:"callback_status"},{title:"Agent Assigned",value:"agent"}],this.fetchReportData("/api/v1/reports/call-summary");break;case"IVR Report":this.headers=[{title:"IVR Path",value:"description"},{title:"Total Calls",value:"total_calls"},{title:"Total Cost",value:"total_airtime"},{title:"Completed",value:"completed"},{title:"Abandoned",value:"abandoned"},{title:"Avg Duration",value:"total_duration	"}];case"Airtime Report":this.headers=[{title:"Agent",value:"agent"},{title:"Total Airtime",value:"total_airtime"},{title:"Avg Duration ",value:"avg_duration"},{title:"Total Calls",value:"total_calls"},{title:"Period ",value:"filter_dates"}],this.fetchReportData("/api/v1/reports/call-summary");break}},async fetchReportData(r){try{const l=await R.post(r,{startDate:this.startDate,endDate:this.endDate,status:this.selectedStatus,user_id:this.selectedAgent,ivrOptions:this.selectedIvrOption,reportType:this.selectedReportType});this.reportData=l.data}catch(l){console.error("Error fetching report:",l)}},downloadReport(){console.log("Download clicked for:",this.selectedReportType)}}};function U(r,l,i,k,t,h){const g=o("v-spacer"),A=o("v-divider"),m=o("v-text-field"),n=o("v-col"),_=o("v-icon"),v=o("v-btn"),y=o("v-row"),d=o("v-autocomplete"),V=o("v-data-table"),C=o("v-container"),D=o("v-card"),b=o("v-main"),T=o("v-app"),E=o("AppLayout");return c(),p(E,null,{default:a(()=>[e(T,null,{default:a(()=>[e(b,null,{default:a(()=>[e(g),e(A),e(y,{class:"mt-4"},{default:a(()=>[e(n,null,{default:a(()=>[e(m,{modelValue:t.search,"onUpdate:modelValue":l[0]||(l[0]=s=>t.search=s),label:"Search","prepend-inner-icon":"mdi-magnify",clearable:"",outlined:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"auto"},{default:a(()=>[e(v,{icon:""},{default:a(()=>[e(_,null,{default:a(()=>[u("mdi-filter-variant")]),_:1})]),_:1})]),_:1})]),_:1}),e(D,{class:"my-card"},{default:a(()=>[e(C,null,{default:a(()=>[e(y,null,{default:a(()=>[e(n,{cols:"12",md:"4"},{default:a(()=>[e(d,{modelValue:t.selectedReportType,"onUpdate:modelValue":l[1]||(l[1]=s=>t.selectedReportType=s),items:t.reportTypes,label:"Report Type"},null,8,["modelValue","items"])]),_:1}),e(n,{cols:"12",md:"4"},{default:a(()=>[e(m,{modelValue:t.startDate,"onUpdate:modelValue":l[2]||(l[2]=s=>t.startDate=s),label:"Start Date","prepend-icon":"mdi-calendar",type:"date",outlined:""},null,8,["modelValue"])]),_:1}),e(n,{cols:"12",md:"4"},{default:a(()=>[e(m,{modelValue:t.endDate,"onUpdate:modelValue":l[3]||(l[3]=s=>t.endDate=s),label:"End Date","prepend-icon":"mdi-calendar",type:"date",outlined:""},null,8,["modelValue"])]),_:1}),t.selectedReportType!=="IVR Report"?(c(),p(n,{key:0,cols:"12",md:"4"},{default:a(()=>[e(d,{modelValue:t.selectedStatus,"onUpdate:modelValue":l[4]||(l[4]=s=>t.selectedStatus=s),items:t.statusTypes,label:"Call Status",multiple:""},null,8,["modelValue","items"])]),_:1})):f("",!0),t.selectedReportType==="IVR Report"?(c(),p(n,{key:1,cols:"12",md:"4"},{default:a(()=>[e(d,{modelValue:r.selectedIvrOption,"onUpdate:modelValue":l[5]||(l[5]=s=>r.selectedIvrOption=s),items:t.ivrOptions,label:"IVR Options","item-title":"description","item-value":"id",clearable:"",multiple:""},null,8,["modelValue","items"])]),_:1})):f("",!0),t.selectedReportType==="Agent Performance"||t.selectedReportType==="IVR Report"?(c(),p(n,{key:2,cols:"12",md:"4"},{default:a(()=>[e(d,{modelValue:t.selectedAgent,"onUpdate:modelValue":l[6]||(l[6]=s=>t.selectedAgent=s),items:t.users,label:"Select Agent","item-title":"name","item-value":"id",clearable:"",multiple:""},null,8,["modelValue","items"])]),_:1})):f("",!0),e(n,{cols:"12",class:"text-right"},{default:a(()=>[e(v,{color:"primary",onClick:h.generateReport},{default:a(()=>[e(_,{left:""},{default:a(()=>[u("mdi-magnify")]),_:1}),u(" Search ")]),_:1},8,["onClick"]),e(v,{color:"secondary",onClick:h.downloadReport},{default:a(()=>[e(_,{left:""},{default:a(()=>[u("mdi-download")]),_:1}),u(" Download ")]),_:1},8,["onClick"])]),_:1})]),_:1}),e(V,{headers:t.headers,items:t.reportData,"items-per-page":10,search:t.search,class:"elevation-1"},null,8,["headers","items","search"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const w=O(S,[["render",U]]);export{w as default};
