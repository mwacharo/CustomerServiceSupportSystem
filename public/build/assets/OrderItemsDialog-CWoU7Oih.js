import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{i as r,o as V,d as b,b as e,w as t,F as O,f as n,t as C}from"./app-TdTcKE9T.js";const q={props:{value:{type:Boolean,default:!1},order:{type:Object,default:()=>null}},data(){return{dialog:!1,editDialog:!1,deleteDialog:!1,loading:!1,currentOrder:null,orderItems:[],editedIndex:-1,editedItem:{id:null,name:"",quantity:1,price:"",sku_no:"",total_price:""},defaultItem:{id:null,name:"",quantity:1,price:"",sku_no:"",total_price:""},itemHeaders:[{title:"Product",key:"name",align:"start"},{title:"SKU",key:"sku_no",align:"start"},{title:"Quantity",key:"quantity",align:"center"},{title:"Price",key:"price",align:"end"},{title:"Total",key:"total_price",align:"end"},{title:"Actions",key:"actions",sortable:!1,align:"center"}]}},watch:{value(l){this.dialog=l},dialog(l){l?this.loadOrderItems():this.$emit("input",!1)},order(l){l&&(this.currentOrder=JSON.parse(JSON.stringify(l)),this.loadOrderItems())}},methods:{loadOrderItems(){this.currentOrder&&(this.loading=!0,this.currentOrder.order_items&&this.currentOrder.order_items.length?this.orderItems=this.currentOrder.order_items.map(l=>({id:l.id,name:l.product_name||`Product #${l.product_id}`,quantity:l.quantity,price:l.price,sku_no:l.sku_no,total_price:l.total_price,product_id:l.product_id})):this.orderItems=[],this.loading=!1)},closeDialog(){this.dialog=!1,this.$emit("input",!1)},editItem(l){this.editedIndex=this.orderItems.indexOf(l),this.editedItem=Object.assign({},l),this.editDialog=!0},closeEditDialog(){this.editDialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},async saveItem(){try{this.editedItem.total_price=(parseFloat(this.editedItem.price)*parseInt(this.editedItem.quantity)).toFixed(2),this.editedIndex>-1&&Object.assign(this.orderItems[this.editedIndex],this.editedItem),this.$emit("item-updated",this.editedItem),this.closeEditDialog()}catch(l){console.error("Error updating item:",l)}},confirmDeleteItem(l){this.editedIndex=this.orderItems.indexOf(l),this.editedItem=Object.assign({},l),this.deleteDialog=!0},closeDeleteDialog(){this.deleteDialog=!1,this.$nextTick(()=>{this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1})},async deleteItem(){try{this.orderItems.splice(this.editedIndex,1),this.$emit("item-deleted",this.editedItem),this.closeDeleteDialog()}catch(l){console.error("Error deleting item:",l)}}}};function w(l,o,U,E,i,a){const u=r("v-spacer"),_=r("v-icon"),s=r("v-btn"),f=r("v-card-title"),x=r("v-data-table"),p=r("v-card-text"),I=r("v-card-actions"),g=r("v-card"),h=r("v-dialog"),c=r("v-text-field"),m=r("v-col"),k=r("v-row"),v=r("v-container");return V(),b(O,null,[e(h,{modelValue:i.dialog,"onUpdate:modelValue":o[0]||(o[0]=d=>i.dialog=d),"max-width":"900px"},{default:t(()=>[e(g,null,{default:t(()=>[e(f,{class:"text-h5 bg-primary text-white"},{default:t(()=>[n(" Order Details: "+C(i.currentOrder?i.currentOrder.order_no:"")+" ",1),e(u),e(s,{icon:"",onClick:a.closeDialog},{default:t(()=>[e(_,null,{default:t(()=>[n("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1}),e(p,{class:"pt-4"},{default:t(()=>[e(x,{headers:i.itemHeaders,items:i.orderItems,loading:i.loading,class:"elevation-1 mt-4"},{"item.actions":t(({item:d})=>[e(s,{icon:"",small:"",class:"mr-2",onClick:y=>a.editItem(d)},{default:t(()=>[e(_,null,{default:t(()=>[n("mdi-pencil")]),_:1})]),_:2},1032,["onClick"]),e(s,{icon:"",small:"",color:"error",onClick:y=>a.confirmDeleteItem(d)},{default:t(()=>[e(_,null,{default:t(()=>[n("mdi-delete")]),_:1})]),_:2},1032,["onClick"])]),_:1},8,["headers","items","loading"])]),_:1}),e(I,null,{default:t(()=>[e(u),e(s,{color:"primary",onClick:a.closeDialog},{default:t(()=>[n("Close")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(h,{modelValue:i.editDialog,"onUpdate:modelValue":o[5]||(o[5]=d=>i.editDialog=d),"max-width":"500px"},{default:t(()=>[e(g,null,{default:t(()=>[e(f,{class:"text-h5"},{default:t(()=>[n("Edit Item")]),_:1}),e(p,null,{default:t(()=>[e(v,null,{default:t(()=>[e(k,null,{default:t(()=>[e(m,{cols:"12"},{default:t(()=>[e(c,{modelValue:i.editedItem.name,"onUpdate:modelValue":o[1]||(o[1]=d=>i.editedItem.name=d),label:"Product Name",required:""},null,8,["modelValue"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(c,{modelValue:i.editedItem.quantity,"onUpdate:modelValue":o[2]||(o[2]=d=>i.editedItem.quantity=d),modelModifiers:{number:!0},label:"Quantity",type:"number",min:"1",required:""},null,8,["modelValue"])]),_:1}),e(m,{cols:"6"},{default:t(()=>[e(c,{modelValue:i.editedItem.price,"onUpdate:modelValue":o[3]||(o[3]=d=>i.editedItem.price=d),label:"Price",prefix:"$",required:""},null,8,["modelValue"])]),_:1}),e(m,{cols:"12"},{default:t(()=>[e(c,{modelValue:i.editedItem.sku_no,"onUpdate:modelValue":o[4]||(o[4]=d=>i.editedItem.sku_no=d),label:"SKU",required:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(u),e(s,{color:"blue-darken-1",text:"",onClick:a.closeEditDialog},{default:t(()=>[n("Cancel")]),_:1},8,["onClick"]),e(s,{color:"blue-darken-1",text:"",onClick:a.saveItem},{default:t(()=>[n("Save")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(h,{modelValue:i.deleteDialog,"onUpdate:modelValue":o[6]||(o[6]=d=>i.deleteDialog=d),"max-width":"400px"},{default:t(()=>[e(g,null,{default:t(()=>[e(f,{class:"text-h5"},{default:t(()=>[n("Delete Item")]),_:1}),e(p,null,{default:t(()=>[n(" Are you sure you want to delete this item? ")]),_:1}),e(I,null,{default:t(()=>[e(u),e(s,{color:"blue-darken-1",text:"",onClick:a.closeDeleteDialog},{default:t(()=>[n("Cancel")]),_:1},8,["onClick"]),e(s,{color:"error",text:"",onClick:a.deleteItem},{default:t(()=>[n("Delete")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const N=D(q,[["render",w],["__scopeId","data-v-6d866376"]]);export{N as default};
