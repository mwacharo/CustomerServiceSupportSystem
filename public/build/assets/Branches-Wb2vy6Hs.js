import{A}from"./AppLayout-EYJu1Oql.js";import{s as m,i as r,o as K,c as H,w as t,b as e,x as O,f as n,t as p,n as P,a as T,h as k}from"./app-DiwwXVwb.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q={components:{AppLayout:A},data(){return{search:"",headers:[{title:"#",value:"index"},{title:"Name",value:"name"},{title:"Headquarters",value:"headquarters"},{title:"Email",value:"email"},{title:"Phone",value:"phone"},{title:"Actions",value:"actions",sortable:!1}],branches:[],editedIndex:-1,editedItem:{name:"",headquarters:"",email:"",phone:"",status:!1},defaultItem:{name:"",headquarters:"",email:"",phone:"",status:!1},dialog:!1,dialogDelete:!1}},computed:{filteredBranches(){return this.search?this.branches.filter(o=>o.name.toLowerCase().includes(this.search.toLowerCase())||o.headquarters.toLowerCase().includes(this.search.toLowerCase())||o.email.toLowerCase().includes(this.search.toLowerCase())||o.phone.toLowerCase().includes(this.search.toLowerCase())):this.branches},formTitle(){return this.editedIndex===-1?"New Branch":"Edit Branch"}},created(){this.fetchBranches()},methods:{fetchBranches(){m.get("/api/v1/branches").then(l=>{this.branches=l.data.branches.map((_,f)=>({..._,index:f+1,statusIcon:_.status?"mdi-checkbox-marked-circle":"mdi-checkbox-blank-circle-outline"}))}).catch(l=>{console.log(l)})},addBranch(){this.editedItem={...this.defaultItem},this.dialog=!0},editItem(o){this.editedIndex=this.branches.indexOf(o),this.editedItem={...o},this.dialog=!0},deleteItem(o){this.editedIndex=this.branches.indexOf(o),this.editedItem={...o},this.dialogDelete=!0},saveBranch(){if(this.editedIndex>-1){const o=`/api/v1/branches/${this.editedItem.id}`;m.put(o,this.editedItem).then(l=>{this.fetchBranches(),this.$toastr.success("Branch updated successfully"),this.closeDialog()}).catch(l=>{this.$toastr.error("Error updating branch"),console.error("Error updating branch:",l)})}else m.post("/api/v1/branches",this.editedItem).then(l=>{this.$toastr.success("Branch created successfully"),this.branches.push({...l.data,index:this.branches.length+1}),this.closeDialog()}).catch(l=>{this.$toastr.error("Error adding branch"),console.error("Error adding branch:",l)})},deleteBranchConfirm(){const o=`/api/v1/branches/${this.editedItem.id}`;m.delete(o).then(l=>{this.branches.splice(this.editedIndex,1),this.$toastr.success("Branch deleted successfully"),this.closeDelete()}).catch(l=>{this.$toastr.error("Error deleting branch"),console.error("Error deleting branch:",l)})},closeDialog(){this.dialog=!1,this.editedItem={...this.defaultItem},this.editedIndex=-1},closeDelete(){this.dialogDelete=!1,this.editedItem={...this.defaultItem},this.editedIndex=-1},refreshBranches(){this.fetchBranches()},toggleBranchStatus(o){o.status=!o.status},filterBranches(){}}},M={class:"text-h5"};function j(o,l,_,f,s,d){const i=r("v-text-field"),v=r("v-container"),b=r("VCard"),C=r("v-toolbar-title"),B=r("v-divider"),g=r("v-spacer"),c=r("v-icon"),u=r("v-btn"),V=r("v-toolbar"),y=r("v-data-table"),w=r("v-card-title"),h=r("v-col"),D=r("v-row"),L=r("v-card-text"),E=r("v-card-actions"),q=r("v-card"),x=r("v-dialog"),U=r("v-alert"),N=r("v-container-fluid"),S=r("AppLayout");return K(),H(S,null,{default:t(()=>[e(b,{class:"my-card"},{default:t(()=>[e(v,null,{default:t(()=>[e(i,{modelValue:o.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=a=>o.searchQuery=a),label:"Search",onKeyup:O(o.performSearch,["enter"]),variant:"outlined"},null,8,["modelValue","onKeyup"])]),_:1})]),_:1}),e(b,{class:"my-card",outlined:""},{default:t(()=>[e(N,null,{default:t(()=>[e(V,{flat:""},{default:t(()=>[e(C,null,{default:t(()=>[n("Branches")]),_:1}),e(B,{class:"mx-4",inset:"",vertical:""}),e(g),e(u,{color:"primary",onClick:d.addBranch},{default:t(()=>[e(c,null,{default:t(()=>[n("mdi-bank-plus")]),_:1})]),_:1},8,["onClick"]),e(u,{color:"primary",onClick:d.refreshBranches},{default:t(()=>[e(c,null,{default:t(()=>[n("mdi-refresh")]),_:1})]),_:1},8,["onClick"])]),_:1}),e(i,{modelValue:s.search,"onUpdate:modelValue":l[1]||(l[1]=a=>s.search=a),label:"Search",clearable:"",onInput:d.filterBranches,dense:""},null,8,["modelValue","onInput"]),e(y,{headers:s.headers,items:d.filteredBranches},{"item.status":t(({item:a})=>[e(c,{color:a.status?"success":"error"},{default:t(()=>[n(p(a.status?"mdi-checkbox-marked-circle":"mdi-checkbox-blank-circle-outline"),1)]),_:2},1032,["color"])]),"item.actions":t(({item:a})=>[e(c,{color:"blue",onClick:I=>d.editItem(a)},{default:t(()=>[n("mdi-pen")]),_:2},1032,["onClick"]),e(c,{class:P(["mx-2",{"text-success":a.active,"text-error":!a.active}]),size:"small",onClick:I=>d.toggleBranchStatus(a)},{default:t(()=>[n(p((a.active,"mdi-circle")),1)]),_:2},1032,["class","onClick"]),e(c,{color:"red",onClick:I=>d.deleteItem(a)},{default:t(()=>[n("mdi-delete")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"]),e(x,{modelValue:s.dialog,"onUpdate:modelValue":l[6]||(l[6]=a=>s.dialog=a),"max-width":"500px"},{default:t(()=>[e(q,null,{default:t(()=>[e(w,null,{default:t(()=>[T("span",M,p(d.formTitle),1)]),_:1}),e(L,null,{default:t(()=>[e(v,null,{default:t(()=>[e(D,null,{default:t(()=>[e(h,{cols:"12"},{default:t(()=>[e(i,{modelValue:s.editedItem.name,"onUpdate:modelValue":l[2]||(l[2]=a=>s.editedItem.name=a),placeholder:"Branch Name",label:"Name","prepend-icon":"mdi-bank"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:t(()=>[e(i,{modelValue:s.editedItem.headquarters,"onUpdate:modelValue":l[3]||(l[3]=a=>s.editedItem.headquarters=a),placeholder:"Branch Headquarters",label:"Headquarters","prepend-icon":"mdi-map-marker"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:t(()=>[e(i,{modelValue:s.editedItem.email,"onUpdate:modelValue":l[4]||(l[4]=a=>s.editedItem.email=a),placeholder:"Branch Email",label:"Email","prepend-icon":"mdi-email"},null,8,["modelValue"])]),_:1}),e(h,{cols:"12"},{default:t(()=>[e(i,{modelValue:s.editedItem.phone,"onUpdate:modelValue":l[5]||(l[5]=a=>s.editedItem.phone=a),placeholder:"Branch Phone",label:"Phone","prepend-icon":"mdi-phone"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),e(E,null,{default:t(()=>[e(u,{color:"blue darken-1",text:"",onClick:k(d.closeDialog,["prevent"])},{default:t(()=>[n("Cancel")]),_:1},8,["onClick"]),e(u,{color:"blue darken-1",text:"",onClick:k(d.saveBranch,["prevent"])},{default:t(()=>[n("Save")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(x,{modelValue:s.dialogDelete,"onUpdate:modelValue":l[7]||(l[7]=a=>s.dialogDelete=a),"max-width":"500px"},{default:t(()=>[e(U,{text:"Are you sure you want to delete this item?!",title:"Delete Branch",type:"error"},{actions:t(()=>[e(u,{color:"blue darken-1",text:"",onClick:d.closeDelete},{default:t(()=>[e(c,{left:""},{default:t(()=>[n("mdi-close")]),_:1}),n(" Cancel ")]),_:1},8,["onClick"]),e(u,{color:"blue darken-1",text:"",onClick:d.deleteBranchConfirm},{default:t(()=>[e(c,{left:""},{default:t(()=>[n("mdi-check")]),_:1}),n(" OK ")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}const R=z(Q,[["render",j],["__scopeId","data-v-b13103d9"]]);export{R as default};
