import{_ as z}from"./AppLayout-BfyyaCKZ.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{i as d,o as f,c as h,w as l,a as s,b as t,f as o,d as b,g as A,F as P,e as _,t as m,n as U}from"./app-BgFgvXwd.js";const R=[{product:"Phone",status:"Shipped",COD:500,client:"John Doe",phone:"123-456-7890",email:"john@example.com",altPhone:"111-222-3333",location:"Portland, Oregon",orders:[{product:"Tablet",status:"Delivered"},{product:"Laptop",status:"Pending"}]}],G={async fetch({page:e,itemsPerPage:a,sortBy:V,search:S}){return new Promise(D=>{setTimeout(()=>{const u=(e-1)*a,i=u+a,p=R.filter(q=>!0),g=p.slice(u,i);D({items:g,total:p.length})},500)})}},X={components:{AppLayout:z},data:()=>({itemsPerPage:5,tab:"calls",isCalling:!1,queueDialog:!1,transferDialog:!1,callAgentDialog:!1,queuedCalls:[],selectedAgent:null,agents:[{name:"Mark D",status:"available"},{name:"Pippa M",status:"engaged"},{name:"Russ N",status:"engaged"},{name:"Elif T",status:"engaged"}],queuedCalls:[{call_id:1,phone_number:"+254711123456",status:"queued"},{call_id:2,phone_number:"+254712345678",status:"queued"},{call_id:3,phone_number:"+254713456789",status:"queued"},{call_id:4,phone_number:"+254714567890",status:"queued"}],queuedCallsheaders:[{title:"Call ID",value:"call_id"},{title:"Phone Number",value:"phone_number"},{title:"Status",value:"status"},{title:"Actions",value:"actions",sortable:!1}],headers:[{title:"Product",align:"start",key:"product"},{title:"Status",key:"status",align:"start"},{title:"COD",key:"COD",align:"end"},{title:"Client",key:"client",align:"start"},{title:"Phone",key:"phone",align:"start"}],callsheaders:[{title:"Created At",value:"createdAt"},{title:"Caller No.",value:"callerNo"},{title:"Phone",value:"phone"},{title:"Call Session State",value:"callSessionState"},{title:"Duration In Seconds",value:"duration"},{title:"Amount",value:"amount"},{title:"Caller Carrier",value:"callerCarrier"},{title:"Call Status",value:"callStatus"},{title:"Actions",value:"actions",sortable:!1}],calls:[{id:1,createdAt:"2025-01-26 10:00",callerNo:"254712345678",phone:"254723456789",callSessionState:"Completed",duration:120,amount:"KES 30",callerCarrier:"Safaricom",callStatus:"Success"},{id:2,createdAt:"2025-01-26 10:30",callerNo:"254723456789",phone:"254734567890",callSessionState:"Missed",duration:0,amount:"KES 0",callerCarrier:"Airtel",callStatus:"Missed"}],serverItems:[{product:"Phone",status:"Shipped",COD:500,client:"John Doe",phone:"123-456-7890"},{product:"Tablet",status:"Pending",COD:700,client:"Jane Doe",phone:"234-567-8901"}],loading:!1,totalItems:2,statuses:["Pending","Shipped","Delivered","Cancelled"],statusModal:!1,phonePopup:!1,newCall:!1,selectedItem:null,selectedItem:{phone:""}}),methods:{closeDialog(){this.callAgentDialog=!1},openCallAgent(){this.callAgentDialog=!0},openTransferDialog(){this.transferDialog=!0},handleTransfer(){this.selectedAgent?axios.post("/api/v1/transfer-call",{agentId:this.selectedAgent}).then(e=>{console.log("Call transferred successfully"),this.transferDialog=!1}).catch(e=>{console.error("Error transferring call:",e)}):console.log("No agent selected")},openQueueDialog(){this.fetchQueuedCalls(),this.queueDialog=!0},fetchQueuedCalls(){axios.get("/api/v1/queued-calls").then(e=>{this.queuedCalls=e.data}).catch(e=>{console.error("Error fetching queued calls:",e)})},dequeueCall(e){axios.post("/api/v1/dequeue-call",{callId:e}).then(a=>{console.log("Call dequeued:",a.data),this.fetchQueuedCalls()}).catch(a=>{console.error("Error dequeuing call:",a)})},handleHangup(){this.callId?axios.post("/api/v1/hangup-call",{callId:this.callId}).then(e=>{this.isCalling=!1,console.log("Call ended",e.data)}).catch(e=>{console.error("Error ending the call",e)}):console.log("Call ID not available")},handleHold(){this.callId?axios.post("/api/v1/hold-call",{callId:this.callId}).then(e=>{console.log("Call on hold",e.data)}).catch(e=>{console.error("Error putting the call on hold",e)}):console.log("Call ID not available")},handleTransfer(){this.callId?axios.post("/api/v1/transfer-call",{callId:this.callId,destination:"254700000000"}).then(a=>{console.log("Call transferred",a.data)}).catch(a=>{console.error("Error transferring the call",a)}):console.log("Call ID not available")},loadItems({page:e,itemsPerPage:a,sortBy:V}){this.loading=!0,G.fetch({page:e,itemsPerPage:a,sortBy:V,search:{}}).then(({items:S,total:D})=>{this.serverItems=S,this.totalItems=D,this.loading=!1})},openStatusModal(e){this.selectedItem=e,this.statusModal=!0},updateStatus(e,a){e.status=a,this.statusModal=!1},openPhonePopup(e){this.selectedItem=e,this.phonePopup=!0},handleCall(e){this.selectedAgent=e,this.callAgentDialog=!1,console.log("Calling agent:",e)},formatPhoneNumber(e){if(!e)return"";if(e=e.replace(/\D/g,""),e.startsWith("0"))e="+254"+e.substring(1);else if(e.startsWith("254"))e="+254"+e.substring(3);else return e.startsWith("+254")?e:(this.$toastr.error("Invalid phone number format"),"");return e},callClient(e){if(e=this.formatPhoneNumber(e),!e){this.phone="",this.newCall=!1;return}this.isCalling=!0,this.$toastr.error("Please enter a valid phone number"),console.log(`Calling ${e}...`),axios.post("/api/v1/call-centre-make-call",{phone:e}).then(a=>{console.log("Call initiated",a),this.newCall=!1}).catch(a=>{console.error("Error initiating call",a)})},watch:{availableAgents(e){this.availableAgents=e.filter(a=>!a.isInCall)}}}},Y={class:"p-4"},Z=s("span",{class:"ml-3"},"Make a new Call",-1),x=s("span",{class:"ml-3"},"Call an agent",-1),ee={class:"d-flex align-center mt-2"},le=s("span",{class:"ml-3"},"Missed Calls",-1),te=s("span",{class:"ml-auto"},"60,400",-1),ae=s("span",{class:"ml-3"},"Check Queue",-1),ne=s("span",{class:"ml-auto"},"...",-1),se={class:"d-flex align-center"},oe=s("span",null,"AM",-1),ue=s("div",null,[s("p",{class:"mb-0"},"John Mwacahro"),s("small",null,"john.boxleo@gmail.com")],-1),de=s("div",{class:"mt-4"},[s("p",null,[o("Calls connected: "),s("strong",null,"0")]),s("p",null,[o("Calls made: "),s("strong",null,"0")]),s("p",null,[o("Calls rejected: "),s("strong",null,"0")]),s("p",null,[o("Incoming Calls: "),s("strong",null,"0")])],-1),ie=["onClick"],re=["onClick"],ce=s("p",null,"Select an agent to call:",-1),fe=s("strong",null,"Name:",-1),me=s("strong",null,"Email:",-1),pe=s("strong",null,"Phone:",-1),ge=s("strong",null,"Alternative Phone:",-1),he=s("strong",null,"Location:",-1);function _e(e,a,V,S,D,u){const i=d("v-icon"),p=d("v-card-text"),g=d("v-card"),q=d("v-col"),Q=d("v-avatar"),L=d("v-chip"),B=d("v-row"),T=d("v-tab"),J=d("v-tabs"),c=d("v-btn"),w=d("v-data-table"),E=d("v-tab-item"),j=d("v-tabs-items"),C=d("v-card-title"),N=d("v-list-item"),M=d("v-list"),k=d("v-card-actions"),v=d("v-dialog"),I=d("v-spacer"),F=d("v-text-field"),W=d("v-container"),$=d("AppLayout");return f(),h($,null,{default:l(()=>[s("div",Y,[t(W,null,{default:l(()=>[t(B,null,{default:l(()=>[t(q,{cols:"12",md:"6"},{default:l(()=>[t(g,null,{default:l(()=>[t(p,null,{default:l(()=>[s("div",{class:"d-flex align-center",onClick:a[0]||(a[0]=n=>e.newCall=!0)},[t(i,{color:"green"},{default:l(()=>[o("mdi-phone")]),_:1}),Z]),s("div",{class:"d-flex align-center mt-2",onClick:a[1]||(a[1]=(...n)=>u.openCallAgent&&u.openCallAgent(...n))},[t(i,{color:"blue"},{default:l(()=>[o("mdi-account")]),_:1}),x]),s("div",ee,[t(i,{color:"red"},{default:l(()=>[o("mdi-phone-missed")]),_:1}),le,te]),s("div",{class:"d-flex align-center mt-2",onClick:a[2]||(a[2]=(...n)=>u.openQueueDialog&&u.openQueueDialog(...n))},[t(i,{color:"orange"},{default:l(()=>[o("mdi-check-decagram")]),_:1}),ae,ne])]),_:1})]),_:1})]),_:1}),t(q,{cols:"12",md:"6"},{default:l(()=>[t(g,null,{default:l(()=>[t(p,null,{default:l(()=>[s("div",se,[t(Q,{class:"mr-3",color:"blue",size:"40"},{default:l(()=>[oe]),_:1}),ue,t(L,{class:"ml-auto",color:"green","text-color":"white"},{default:l(()=>[o("Online")]),_:1})]),de]),_:1})]),_:1})]),_:1})]),_:1}),t(g,null,{default:l(()=>[t(J,{modelValue:e.tab,"onUpdate:modelValue":a[3]||(a[3]=n=>e.tab=n),color:"primary"},{default:l(()=>[t(T,{value:"calls"},{default:l(()=>[o("Calls")]),_:1}),t(T,{value:"orders"},{default:l(()=>[o("Orders")]),_:1})]),_:1},8,["modelValue"]),t(j,{modelValue:e.tab,"onUpdate:modelValue":a[4]||(a[4]=n=>e.tab=n)},{default:l(()=>[t(E,{value:"calls"},{default:l(()=>[t(w,{headers:e.callsheaders,items:e.calls,"item-value":"id",class:"elevation-1 mt-4","items-per-page":10},{"item.actions":l(({item:n})=>[t(c,{icon:"",color:"red"},{default:l(()=>[t(i,null,{default:l(()=>[o("mdi-record-circle")]),_:1})]),_:1})]),_:1},8,["headers","items"])]),_:1}),t(E,{value:"orders"},{default:l(()=>[t(w,{headers:e.headers,items:e.serverItems,loading:e.loading,class:"elevation-1 mt-4"},{body:l(({items:n})=>[(f(!0),b(P,null,A(n,r=>(f(),b("tr",{key:r.product},[s("td",null,m(r.product),1),s("td",null,[s("span",{class:"clickable",onClick:y=>u.openStatusModal(r)},m(r.status),9,ie)]),s("td",null,m(r.COD),1),s("td",null,m(r.client),1),s("td",null,[s("span",{class:"clickable",onClick:y=>u.openPhonePopup(r)},m(r.phone),9,re)])]))),128))]),_:1},8,["headers","items","loading"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(v,{modelValue:e.callAgentDialog,"onUpdate:modelValue":a[5]||(a[5]=n=>e.callAgentDialog=n),"max-width":"400"},{default:l(()=>[t(g,null,{default:l(()=>[t(C,{class:"headline"},{default:l(()=>[o("Call an Agent")]),_:1}),t(p,null,{default:l(()=>[ce,t(M,null,{default:l(()=>[(f(!0),b(P,null,A(e.agents,n=>(f(),h(N,{key:n.name,onClick:r=>u.handleCall(n),class:"agent-item"},{default:l(()=>[s("div",null,[s("strong",null,m(n.name),1),s("span",{class:U({"text-success":n.status==="available","text-warning":n.status==="engaged","text-grey":n.status==="offline"})}," - "+m(n.status),3)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(c,{color:"blue darken-1",text:"",onClick:u.closeDialog},{default:l(()=>[o("Cancel")]),_:1},8,["onClick"]),e.isCalling?(f(),h(c,{key:0,color:"red",onClick:u.handleHangup},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-phone-off")]),_:1}),o(" Hangup ")]),_:1},8,["onClick"])):_("",!0),e.isCalling?(f(),h(c,{key:1,color:"grey",onClick:u.handleHold},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-pause")]),_:1}),o(" Hold ")]),_:1},8,["onClick"])):_("",!0),e.isCalling?(f(),h(c,{key:2,color:"blue",onClick:u.openTransferDialog},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-phone-transfer")]),_:1}),o(" Transfer ")]),_:1},8,["onClick"])):_("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(v,{modelValue:e.statusModal,"onUpdate:modelValue":a[7]||(a[7]=n=>e.statusModal=n),"max-width":"400"},{default:l(()=>[t(g,null,{default:l(()=>[t(C,null,{default:l(()=>[o("Select Status")]),_:1}),t(p,null,{default:l(()=>[t(M,null,{default:l(()=>[(f(!0),b(P,null,A(e.statuses,n=>(f(),h(N,{key:n,onClick:r=>u.updateStatus(e.selectedItem,n)},{default:l(()=>[o(m(n),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(k,null,{default:l(()=>[t(c,{color:"primary",text:"",onClick:a[6]||(a[6]=n=>e.statusModal=!1)},{default:l(()=>[o("Close")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(v,{modelValue:e.queueDialog,"onUpdate:modelValue":a[9]||(a[9]=n=>e.queueDialog=n),"max-width":"600"},{default:l(()=>[t(g,null,{default:l(()=>[t(C,null,{default:l(()=>[o(" Queued Calls "),t(I),t(c,{icon:"",onClick:a[8]||(a[8]=n=>e.queueDialog=!1)},{default:l(()=>[t(i,null,{default:l(()=>[o("mdi-close")]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(w,{headers:e.queuedCallsheaders,items:e.queuedCalls,"item-value":"id",class:"elevation-1"},{"item.actions":l(({item:n})=>[t(c,{color:"green",onClick:r=>u.dequeueCall(n.id)},{default:l(()=>[o(" Dequeue ")]),_:2},1032,["onClick"])]),_:1},8,["headers","items"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(v,{modelValue:e.newCall,"onUpdate:modelValue":a[13]||(a[13]=n=>e.newCall=n),"max-width":"600"},{default:l(()=>[t(g,null,{default:l(()=>[t(C,null,{default:l(()=>[o(" Client Details "),t(I),t(c,{icon:"",onClick:a[10]||(a[10]=n=>e.newCall=!1)},{default:l(()=>[t(i,null,{default:l(()=>[o("mdi-close")]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(F,{modelValue:e.phone,"onUpdate:modelValue":a[11]||(a[11]=n=>e.phone=n),label:"Phone Number",type:"text",required:""},null,8,["modelValue"])]),_:1}),t(k,null,{default:l(()=>[s("div",null,[e.isCalling?_("",!0):(f(),h(c,{key:0,color:"success",onClick:a[12]||(a[12]=n=>u.callClient(e.phone))},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-phone")]),_:1}),o(" Call Client ")]),_:1})),e.isCalling?(f(),h(c,{key:1,color:"red",onClick:u.handleHangup},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-phone-off")]),_:1}),o(" Hangup ")]),_:1},8,["onClick"])):_("",!0),e.isCalling?(f(),h(c,{key:2,color:"grey",onClick:u.handleHold},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-pause")]),_:1}),o(" Hold ")]),_:1},8,["onClick"])):_("",!0),e.isCalling?(f(),h(c,{key:3,color:"blue",onClick:u.openTransferDialog},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-phone-transfer")]),_:1}),o(" Transfer ")]),_:1},8,["onClick"])):_("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(v,{modelValue:e.transferDialog,"onUpdate:modelValue":a[15]||(a[15]=n=>e.transferDialog=n),"max-width":"600"},{default:l(()=>[t(g,null,{default:l(()=>[t(C,null,{default:l(()=>[o(" Transfer Call "),t(I),t(c,{icon:"",onClick:a[14]||(a[14]=n=>e.transferDialog=!1)},{default:l(()=>[t(i,null,{default:l(()=>[o("mdi-close")]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>[t(M,null,{default:l(()=>[(f(!0),b(P,null,A(e.agents,n=>(f(),h(N,{onClick:r=>u.handleTransfer(n),key:n.name,class:"agent-item"},{default:l(()=>[s("div",null,[s("strong",null,m(n.name),1),s("span",{class:U({"text-success":n.status==="available","text-warning":n.status==="engaged","text-grey":n.status==="offline"})}," - "+m(n.status),3)])]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),t(k)]),_:1})]),_:1},8,["modelValue"]),t(v,{modelValue:e.phonePopup,"onUpdate:modelValue":a[18]||(a[18]=n=>e.phonePopup=n),"max-width":"600"},{default:l(()=>[t(g,null,{default:l(()=>[t(C,null,{default:l(()=>[o(" Client Details "),t(I),t(c,{icon:"",onClick:a[16]||(a[16]=n=>e.phonePopup=!1)},{default:l(()=>[t(i,null,{default:l(()=>[o("mdi-close")]),_:1})]),_:1})]),_:1}),t(p,null,{default:l(()=>{var n,r,y,H,O;return[s("div",null,[fe,o(" "+m((n=e.selectedItem)==null?void 0:n.client),1)]),s("div",null,[me,o(" "+m((r=e.selectedItem)==null?void 0:r.email),1)]),s("div",null,[pe,o(" "+m((y=e.selectedItem)==null?void 0:y.phone),1)]),s("div",null,[ge,o(" "+m(((H=e.selectedItem)==null?void 0:H.altPhone)||"N/A"),1)]),s("div",null,[he,o(" "+m(((O=e.selectedItem)==null?void 0:O.location)||"N/A"),1)])]}),_:1}),t(k,null,{default:l(()=>[t(c,{color:"primary",onClick:a[17]||(a[17]=n=>{var r;return u.callClient((r=e.selectedItem)==null?void 0:r.phone)})},{default:l(()=>[t(i,{left:""},{default:l(()=>[o("mdi-phone")]),_:1}),o(" Call Client ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])]),_:1})}const be=K(X,[["render",_e]]);export{be as default};
