import{Z as ee}from"./index.esm-Vs8hKJo4.js";import{A as te}from"./AppLayout-BHA5hAQv.js";import{k as le,r as d,y as ae,i as s,o as x,c as P,w as t,J as ne,b as e,u as oe,f as o,t as u,a as n,d as N,g as se,F as ue,s as ie}from"./app-BaJva0lD.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const de=n("h2",{class:"text-h6"},"Email Marketing",-1),re=n("div",{class:"text-subtitle-2"},"Sent",-1),ce={class:"text-h6"},me=n("div",{class:"text-subtitle-2"},"Delivered",-1),ve={class:"text-h6"},pe=n("div",{class:"text-subtitle-2"},"Opened",-1),_e={class:"text-h6"},fe=n("div",{class:"text-subtitle-2"},"Failed",-1),be={class:"text-h6"},he=n("div",null,"Email History",-1),ye=n("thead",null,[n("tr",null,[n("th",null,"Subject"),n("th",null,"Recipients"),n("th",null,"Status"),n("th",null,"Attachments"),n("th",null,"Sent Date"),n("th",null,"Actions")])],-1),Ve={key:1},je={__name:"Emails",setup(we){const $=le(()=>{var i;return(i=ne().props.value.user)==null?void 0:i.id}),z=d(""),S=d([]),B=d([]),_=d([]),v=d(""),p=d(""),b=d([]),C=d(!1),h=d(!1),y=d(!1),V=d([]),c=d({name:"",subject:"",content:""}),I=d("Connected"),j=d({sent:234,delivered:228,opened:156,failed:6}),q=()=>{B.value=[{id:1,name:"John Doe",email:"john.boxleo@gmail.com",status:"Active"},{id:2,name:"Jane Smith",email:"mwacharomwayolo@gmail.com",status:"Active"},{id:3,name:"Robert Brown",email:"robert.brown@example.com",status:"Inactive"},{id:4,name:"Sarah Wilson",email:"sarah.wilson@example.com",status:"Active"}]},J=()=>{b.value=[{id:1,name:"Welcome Email",subject:"Welcome to Our Service",content:`Hello {{name}},

Welcome to our service! We are excited to have you on board.

Best regards,
The Team`},{id:2,name:"Payment Reminder",subject:"Payment Reminder: Invoice #{{invoice_number}}",content:`Dear {{name}},

This is a friendly reminder about your payment of KES {{amount}} due on {{date}}.

Regards,
Finance Department`},{id:3,name:"Monthly Newsletter",subject:"Your Monthly Update - {{month}}",content:`Hello {{name}},

Here are the latest updates for {{month}}:

{{news_items}}

Thank you for your continued support.

Best regards,
Marketing Team`}]},L=i=>{v.value=i.subject,p.value=i.content},K=()=>{b.value.push({id:b.value.length+1,...c.value}),c.value={name:"",subject:"",content:""},y.value=!1},Y=async()=>{try{const i={user_id:$.value,subject:v.value,body:p.value,recipients:_.value.map(m=>m.email),attachments:V.value};if((await ie.post("/api/v1/send-email",i)).status===200){this.$toastr.success("Email sent successfully!");const m=new Date;S.value.unshift({id:S.value.length+1,subject:v.value,content:p.value,recipients:_.value.length,status:"Sent",has_attachments:V.value.length>0,sent_at:m.toISOString().slice(0,10)}),v.value="",p.value="",_.value=[],V.value=[],h.value=!1}else this.$toastr.error("Failed to send email. Please try again.")}catch(i){console.error("Error sending email:",i),this.$toastr.error("An error occurred while sending the email.")}};return ae(()=>{S.value=[{id:1,subject:"April Newsletter",content:"Monthly newsletter content...",recipients:153,status:"Delivered",has_attachments:!0,sent_at:"2025-04-19"},{id:2,subject:"System Maintenance Notice",content:"Notification about planned downtime...",recipients:98,status:"Sent",has_attachments:!1,sent_at:"2025-04-18"},{id:3,subject:"New Features Announcement",content:"Announcement about new platform features...",recipients:215,status:"Delivered",has_attachments:!0,sent_at:"2025-04-17"},{id:4,subject:"Account Verification Required",content:"Security verification reminder...",recipients:5,status:"Opened",has_attachments:!1,sent_at:"2025-04-16"}],q(),J(),console.log("user_id",$.value)}),(i,a)=>{const m=s("v-icon"),Z=s("v-avatar"),T=s("v-chip"),M=s("v-divider"),f=s("v-col"),F=s("v-row"),r=s("v-btn"),w=s("v-card-text"),g=s("v-card"),k=s("v-text-field"),E=s("v-card-title"),G=s("v-table"),Q=s("v-container"),R=s("v-select"),O=s("v-textarea"),W=s("v-file-input"),A=s("v-spacer"),U=s("v-card-actions"),D=s("v-dialog"),H=s("v-alert");return x(),P(te,null,{default:t(()=>[e(oe(ee),{title:"Email"}),e(Q,null,{default:t(()=>[e(F,null,{default:t(()=>[e(f,{cols:"12",md:"3"},{default:t(()=>[e(g,null,{default:t(()=>[e(w,{class:"text-center"},{default:t(()=>[e(Z,{size:"80",color:"blue",class:"mb-3"},{default:t(()=>[e(m,{size:"48",color:"white"},{default:t(()=>[o("mdi-email")]),_:1})]),_:1}),de,e(T,{color:I.value==="Connected"?"success":"error",class:"mt-2"},{default:t(()=>[o(u(I.value),1)]),_:1},8,["color"]),e(M,{class:"my-4"}),e(F,null,{default:t(()=>[e(f,{cols:"6",class:"py-1"},{default:t(()=>[re,n("div",ce,u(j.value.sent),1)]),_:1}),e(f,{cols:"6",class:"py-1"},{default:t(()=>[me,n("div",ve,u(j.value.delivered),1)]),_:1}),e(f,{cols:"6",class:"py-1"},{default:t(()=>[pe,n("div",_e,u(j.value.opened),1)]),_:1}),e(f,{cols:"6",class:"py-1"},{default:t(()=>[fe,n("div",be,u(j.value.failed),1)]),_:1})]),_:1}),e(M,{class:"my-4"}),e(r,{color:"primary",block:"",onClick:a[0]||(a[0]=l=>h.value=!0)},{default:t(()=>[o(" New Email ")]),_:1}),e(r,{color:"secondary",block:"",class:"mt-2",onClick:a[1]||(a[1]=l=>y.value=!0)},{default:t(()=>[o(" Create Template ")]),_:1}),e(r,{color:"info",block:"",class:"mt-2",onClick:a[2]||(a[2]=l=>C.value=!0)},{default:t(()=>[o(" Import Contacts ")]),_:1})]),_:1})]),_:1})]),_:1}),e(f,{cols:"12",md:"9"},{default:t(()=>[e(g,null,{default:t(()=>[e(E,{class:"d-flex justify-space-between align-center"},{default:t(()=>[he,e(k,{modelValue:z.value,"onUpdate:modelValue":a[3]||(a[3]=l=>z.value=l),"append-icon":"mdi-magnify",label:"Search emails","single-line":"","hide-details":"",density:"compact",class:"max-w-xs"},null,8,["modelValue"])]),_:1}),e(w,null,{default:t(()=>[e(G,null,{default:t(()=>[ye,n("tbody",null,[(x(!0),N(ue,null,se(S.value,l=>(x(),N("tr",{key:l.id},[n("td",null,u(l.subject),1),n("td",null,u(l.recipients),1),n("td",null,[e(T,{color:l.status==="Delivered"?"success":l.status==="Opened"?"info":"warning",size:"small"},{default:t(()=>[o(u(l.status),1)]),_:2},1032,["color"])]),n("td",null,[l.has_attachments?(x(),P(m,{key:0,color:"grey"},{default:t(()=>[o("mdi-paperclip")]),_:1})):(x(),N("span",Ve,"-"))]),n("td",null,u(l.sent_at),1),n("td",null,[e(r,{icon:"",size:"small",color:"primary",variant:"text"},{default:t(()=>[e(m,null,{default:t(()=>[o("mdi-refresh")]),_:1})]),_:1}),e(r,{icon:"",size:"small",color:"info",variant:"text"},{default:t(()=>[e(m,null,{default:t(()=>[o("mdi-eye")]),_:1})]),_:1}),e(r,{icon:"",size:"small",color:"error",variant:"text"},{default:t(()=>[e(m,null,{default:t(()=>[o("mdi-delete")]),_:1})]),_:1})])]))),128))])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(D,{modelValue:h.value,"onUpdate:modelValue":a[10]||(a[10]=l=>h.value=l),"max-width":"800px"},{default:t(()=>[e(g,null,{default:t(()=>[e(E,null,{default:t(()=>[o("Compose Email")]),_:1}),e(w,null,{default:t(()=>[e(R,{modelValue:_.value,"onUpdate:modelValue":a[4]||(a[4]=l=>_.value=l),items:B.value,"item-title":"name","item-value":"id",label:"Select Recipients",multiple:"",chips:"","return-object":""},{selection:t(({item:l})=>[e(T,null,{default:t(()=>[o(u(l.raw.name)+" ("+u(l.raw.email)+")",1)]),_:2},1024)]),_:1},8,["modelValue","items"]),e(R,{label:"Select Template",items:b.value,"item-title":"name","item-value":"id","onUpdate:modelValue":a[5]||(a[5]=l=>L(b.value.find(X=>X.id===l))),class:"mt-4"},null,8,["items"]),e(k,{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=l=>v.value=l),label:"Subject",class:"mt-4"},null,8,["modelValue"]),e(O,{modelValue:p.value,"onUpdate:modelValue":a[7]||(a[7]=l=>p.value=l),label:"Message",rows:"10",class:"mt-4",hint:"Variables format: {{variable_name}}","persistent-hint":""},null,8,["modelValue"]),e(W,{modelValue:V.value,"onUpdate:modelValue":a[8]||(a[8]=l=>V.value=l),label:"Attachments",multiple:"","prepend-icon":"mdi-paperclip","show-size":"","truncate-length":"25",class:"mt-4"},null,8,["modelValue"])]),_:1}),e(U,null,{default:t(()=>[e(A),e(r,{color:"error",onClick:a[9]||(a[9]=l=>h.value=!1)},{default:t(()=>[o("Cancel")]),_:1}),e(r,{color:"primary",onClick:Y,disabled:!v.value||!p.value||_.value.length===0},{default:t(()=>[o(" Send Email ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(D,{modelValue:C.value,"onUpdate:modelValue":a[12]||(a[12]=l=>C.value=l),"max-width":"500px"},{default:t(()=>[e(g,null,{default:t(()=>[e(E,null,{default:t(()=>[o("Import Email Contacts")]),_:1}),e(w,null,{default:t(()=>[e(W,{label:"Upload CSV File",accept:".csv","prepend-icon":"mdi-file-upload","show-size":"","truncate-length":"25"}),e(H,{type:"info",class:"mt-4"},{default:t(()=>[o(" CSV file should have columns: Name, Email Address, Status ")]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(A),e(r,{color:"error",onClick:a[11]||(a[11]=l=>C.value=!1)},{default:t(()=>[o("Cancel")]),_:1}),e(r,{color:"primary"},{default:t(()=>[o("Import")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(D,{modelValue:y.value,"onUpdate:modelValue":a[17]||(a[17]=l=>y.value=l),"max-width":"700px"},{default:t(()=>[e(g,null,{default:t(()=>[e(E,null,{default:t(()=>[o("Create Email Template")]),_:1}),e(w,null,{default:t(()=>[e(k,{modelValue:c.value.name,"onUpdate:modelValue":a[13]||(a[13]=l=>c.value.name=l),label:"Template Name",required:""},null,8,["modelValue"]),e(k,{modelValue:c.value.subject,"onUpdate:modelValue":a[14]||(a[14]=l=>c.value.subject=l),label:"Email Subject",required:"",class:"mt-4"},null,8,["modelValue"]),e(O,{modelValue:c.value.content,"onUpdate:modelValue":a[15]||(a[15]=l=>c.value.content=l),label:"Email Content",rows:"10",hint:"Use {{variable_name}} for dynamic content","persistent-hint":"",class:"mt-4"},null,8,["modelValue"]),e(H,{type:"info",class:"mt-4"},{default:t(()=>[o(" Available variables: "+u(i.name)+", "+u(i.email)+", "+u(i.amount)+", "+u(i.date)+", "+u(i.invoice_number)+", "+u(i.month)+", "+u(i.news_items),1)]),_:1})]),_:1}),e(U,null,{default:t(()=>[e(A),e(r,{color:"error",onClick:a[16]||(a[16]=l=>y.value=!1)},{default:t(()=>[o("Cancel")]),_:1}),e(r,{color:"primary",onClick:K,disabled:!c.value.name||!c.value.subject||!c.value.content},{default:t(()=>[o(" Save Template ")]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{je as default};
