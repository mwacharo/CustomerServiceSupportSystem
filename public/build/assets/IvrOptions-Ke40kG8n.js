import{A as $}from"./AppLayout-CsXfrR7a.js";import{s as g,i as s,N as Q,o as E,c as G,w as i,b as t,f as n,t as h,a as u,z as C,h as H,l as R,p as J,j as K}from"./app-BfcNgRga.js";import{_ as W}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={components:{AppLayout:$},data:()=>({dialog:!1,deleteDialog:!1,loading:!1,saving:!1,deleting:!1,valid:!0,searchQuery:"",statusFilter:"All",sortBy:"option_number",sortOrder:"asc",page:1,headers:[{title:"Option #",key:"option_number",align:"start",width:"100px"},{title:"Description",key:"description"},{title:"Forward Number",key:"forward_number",width:"180px"},{title:"Virtual Number",key:"phone_number",width:"180px"},{title:"Status",key:"status",width:"120px"},{title:"Actions",key:"actions",sortable:!1,align:"center",width:"150px"}],ivrOptions:[],filteredIvrOptions:[],editedIndex:-1,editedItem:{option_number:"",description:"",forward_number:"",phone_number:"",status:"inactive",notes:""},defaultItem:{option_number:"",description:"",forward_number:"",phone_number:"",status:"inactive",notes:""},deleteItem:null,phoneNumberMask:"(###) ###-####",searchTimeout:null}),computed:{formTitle(){return this.editedIndex===-1?"Add New IVR Option":"Edit IVR Option"}},created(){this.initialize()},methods:{initialize(){this.loading=!0,g.get("api/v1/ivr-options").then(e=>{this.ivrOptions=e.data.ivrOptions||[],this.filteredIvrOptions=[...this.ivrOptions],this.loading=!1}).catch(e=>{var l;console.error("API Error:",e),this.loading=!1,(l=this.$toast)==null||l.error("Failed to load IVR options")})},debounceSearch(){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.applyFilters()},300)},applyFilters(){let e=[...this.ivrOptions];if(this.searchQuery){const l=this.searchQuery.toLowerCase();e=e.filter(r=>r.option_number.toString().includes(l)||r.description.toLowerCase().includes(l)||r.forward_number.toLowerCase().includes(l)||r.phone_number.toLowerCase().includes(l))}if(this.statusFilter!=="All"){const l=this.statusFilter.toLowerCase();e=e.filter(r=>r.status.toLowerCase()===l)}this.filteredIvrOptions=e,this.page=1},resetFilterAndRefresh(){this.searchQuery="",this.statusFilter="All",this.sortBy="option_number",this.sortOrder="asc",this.initialize()},editItem(e){this.editedIndex=this.ivrOptions.findIndex(l=>l.id===e.id),this.editedItem=Object.assign({},e),this.dialog=!0},confirmDelete(e){this.deleteItem=e,this.deleteDialog=!0},deleteIvrOption(){this.deleting=!0,g.delete(`/api/v1/ivr-options/${this.deleteItem.id}`).then(()=>{var e;this.ivrOptions=this.ivrOptions.filter(l=>l.id!==this.deleteItem.id),this.applyFilters(),this.deleteDialog=!1,this.deleting=!1,(e=this.$toast)==null||e.success("IVR option deleted successfully")}).catch(e=>{var l;console.error("Deletion error:",e),this.deleting=!1,(l=this.$toast)==null||l.error("Failed to delete IVR option")})},close(){this.dialog=!1,this.$nextTick(()=>{this.resetForm()})},resetForm(){var e;(e=this.$refs.form)==null||e.reset(),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){var l;if(!((l=this.$refs.form)!=null&&l.validate()))return;this.saving=!0;let e;this.editedIndex>-1?e=g.put(`/api/v1/ivr-options/${this.editedItem.id}`,this.editedItem):e=g.post("/api/v1/ivr-options",this.editedItem),e.then(r=>{var f;const m=r.data;this.editedIndex>-1?Object.assign(this.ivrOptions[this.editedIndex],m):this.ivrOptions.push(m),this.applyFilters(),this.close(),this.saving=!1,(f=this.$toast)==null||f.success(`IVR option ${this.editedIndex>-1?"updated":"created"} successfully`)}).catch(r=>{var m;console.error("Saving error:",r),this.saving=!1,(m=this.$toast)==null||m.error(`Failed to ${this.editedIndex>-1?"update":"create"} IVR option`)})},toggleStatus(e){const l={...e,status:e.status==="active"?"inactive":"active"};g.put(`/api/v1/ivr-options/${e.id}`,l).then(r=>{var f;const m=this.ivrOptions.findIndex(o=>o.id===e.id);Object.assign(this.ivrOptions[m],r.data),this.applyFilters(),(f=this.$toast)==null||f.success(`Option ${e.option_number} ${l.status==="active"?"activated":"deactivated"}`)}).catch(r=>{var m;console.error("Status toggle error:",r),(m=this.$toast)==null||m.error("Failed to update status")})},updatePage(e){this.page=e},getStatusColor(e){return e==="active"?"success":"grey"},getStatusText(e){return e==="active"?"Active":"Inactive"},formatPhoneNumber(e){if(!e)return"";const l=(""+e).replace(/\D/g,"");return l.length===10?`(${l.substring(0,3)}) ${l.substring(3,6)}-${l.substring(6,10)}`:e},validatePhoneNumber(e){return e.replace(/\D/g,"").length<10?"Phone number must have at least 10 digits":!0}}},y=e=>(J("data-v-69b2cb3d"),e=e(),K(),e),Y=y(()=>u("h4",{class:"text-h4 font-weight-bold primary--text"},"IVR Options Manager",-1)),Z=y(()=>u("p",{class:"text-subtitle-1 text-medium-emphasis mt-1"}," Manage your Interactive Voice Response menu options ",-1)),ee={class:"d-flex align-center"},te={class:"d-flex align-center"},ie={class:"d-flex"},le={class:"d-flex flex-column align-center py-6"},ae=y(()=>u("div",{class:"text-subtitle-1 mt-2"},"No IVR options found",-1)),oe={class:"d-flex justify-center align-center pa-4"},se={class:"d-flex justify-end pa-4"},ne={class:"mt-4 pa-4 bg-grey-lighten-4 rounded"},re=y(()=>u("div",{class:"mt-4 text-caption text-medium-emphasis"}," This action cannot be undone. ",-1));function de(e,l,r,m,f,o){const d=s("v-col"),_=s("v-text-field"),c=s("v-btn"),b=s("v-row"),V=s("v-container"),O=s("VCard"),I=s("v-select"),z=s("v-chip"),v=s("v-icon"),w=s("v-tooltip"),T=s("v-progress-circular"),q=s("v-data-table"),P=s("v-pagination"),k=s("v-spacer"),S=s("v-card-title"),B=s("v-textarea"),L=s("v-form"),F=s("v-card-text"),j=s("v-divider"),N=s("v-card-actions"),D=s("v-card"),x=s("v-dialog"),M=s("AppLayout"),A=Q("mask");return E(),G(M,null,{default:i(()=>[t(O,{class:"my-card elevation-2"},{default:i(()=>[t(V,null,{default:i(()=>[t(b,{align:"center"},{default:i(()=>[t(d,{cols:"12",md:"6"},{default:i(()=>[Y,Z]),_:1}),t(d,{cols:"12",md:"6"},{default:i(()=>[t(b,null,{default:i(()=>[t(d,{cols:"8"},{default:i(()=>[t(_,{modelValue:e.searchQuery,"onUpdate:modelValue":l[0]||(l[0]=a=>e.searchQuery=a),label:"Search IVR Options","prepend-inner-icon":"mdi-magnify",clearable:"",variant:"outlined","hide-details":"",onInput:o.debounceSearch,density:"comfortable",placeholder:"Search by number, description or phone number..."},null,8,["modelValue","onInput"])]),_:1}),t(d,{cols:"4",class:"d-flex align-center"},{default:i(()=>[t(c,{color:"primary","prepend-icon":"mdi-plus",size:"large",class:"text-none",onClick:l[1]||(l[1]=a=>e.dialog=!0)},{default:i(()=>[n(" New Option ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(O,{class:"my-card elevation-1"},{default:i(()=>[t(V,null,{default:i(()=>[t(b,null,{default:i(()=>[t(d,{cols:"12",md:"3"},{default:i(()=>[t(I,{modelValue:e.statusFilter,"onUpdate:modelValue":[l[2]||(l[2]=a=>e.statusFilter=a),o.applyFilters],items:["All","Active","Inactive"],label:"Status",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{cols:"12",md:"3"},{default:i(()=>[t(I,{modelValue:e.sortBy,"onUpdate:modelValue":[l[3]||(l[3]=a=>e.sortBy=a),o.applyFilters],items:[{title:"Option Number",value:"option_number"},{title:"Description",value:"description"},{title:"Virtual Number",value:"phone_number"},{title:"Status",value:"status"}],"item-title":"title","item-value":"value",label:"Sort By",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{cols:"12",md:"3"},{default:i(()=>[t(I,{modelValue:e.sortOrder,"onUpdate:modelValue":[l[4]||(l[4]=a=>e.sortOrder=a),o.applyFilters],items:[{title:"Ascending",value:"asc"},{title:"Descending",value:"desc"}],"item-title":"title","item-value":"value",label:"Sort Order",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(d,{cols:"12",md:"3",class:"d-flex align-center justify-end"},{default:i(()=>[t(c,{variant:"text",color:"primary","prepend-icon":"mdi-refresh",onClick:o.resetFilterAndRefresh},{default:i(()=>[n(" Reset Filters ")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),t(O,{class:"my-card elevation-2"},{default:i(()=>[t(q,{headers:e.headers,loading:e.loading,items:e.filteredIvrOptions,"items-per-page":10,"sort-by":[{key:e.sortBy,order:e.sortOrder}],class:"elevation-0"},{"item.status":i(({item:a})=>[t(z,{color:o.getStatusColor(a.status),"text-color":"white",size:"small",label:""},{default:i(()=>[n(h(o.getStatusText(a.status)),1)]),_:2},1032,["color"])]),"item.phone_number":i(({item:a})=>[u("div",ee,[t(v,{size:"small",color:"primary",class:"me-2"},{default:i(()=>[n("mdi-phone")]),_:1}),n(" "+h(o.formatPhoneNumber(a.phone_number)),1)])]),"item.forward_number":i(({item:a})=>[u("div",te,[t(v,{size:"small",color:"success",class:"me-2"},{default:i(()=>[n("mdi-call-split")]),_:1}),n(" "+h(o.formatPhoneNumber(a.forward_number)),1)])]),"item.actions":i(({item:a})=>[u("div",ie,[t(w,{text:"Edit Option"},{activator:i(({props:p})=>[t(c,C({icon:"",size:"small",color:"primary",class:"me-2"},p,{onClick:U=>o.editItem(a)}),{default:i(()=>[t(v,null,{default:i(()=>[n("mdi-pencil")]),_:1})]),_:2},1040,["onClick"])]),_:2},1024),t(w,{text:"Toggle Status"},{activator:i(({props:p})=>[t(c,C({icon:"",size:"small",color:a.status==="active"?"warning":"success",class:"me-2"},p,{onClick:U=>o.toggleStatus(a)}),{default:i(()=>[t(v,null,{default:i(()=>[n(h(a.status==="active"?"mdi-pause":"mdi-play"),1)]),_:2},1024)]),_:2},1040,["color","onClick"])]),_:2},1024),t(w,{text:"Delete Option"},{activator:i(({props:p})=>[t(c,C({icon:"",size:"small",color:"error"},p,{onClick:U=>o.confirmDelete(a)}),{default:i(()=>[t(v,null,{default:i(()=>[n("mdi-delete")]),_:1})]),_:2},1040,["onClick"])]),_:2},1024)])]),"no-data":i(()=>[u("div",le,[t(v,{size:"large",color:"grey"},{default:i(()=>[n("mdi-phone-off")]),_:1}),ae,t(c,{color:"primary",class:"mt-4",onClick:o.initialize},{default:i(()=>[n("Reset")]),_:1},8,["onClick"])])]),loading:i(()=>[u("div",oe,[t(T,{indeterminate:"",color:"primary",size:"48"})])]),_:1},8,["headers","loading","items","sort-by"]),u("div",se,[t(P,{modelValue:e.page,"onUpdate:modelValue":[l[5]||(l[5]=a=>e.page=a),o.updatePage],length:Math.ceil(e.filteredIvrOptions.length/10),rounded:"circle"},null,8,["modelValue","length","onUpdate:modelValue"])])]),_:1}),t(x,{modelValue:e.dialog,"onUpdate:modelValue":l[13]||(l[13]=a=>e.dialog=a),"max-width":"600px",persistent:""},{default:i(()=>[t(D,null,{default:i(()=>[t(S,{class:"text-h5 bg-primary text-white pa-4"},{default:i(()=>[n(h(o.formTitle)+" ",1),t(k),t(c,{icon:"",variant:"text",onClick:o.close,color:"white"},{default:i(()=>[t(v,null,{default:i(()=>[n("mdi-close")]),_:1})]),_:1},8,["onClick"])]),_:1}),t(F,{class:"pa-4"},{default:i(()=>[t(L,{ref:"form",modelValue:e.valid,"onUpdate:modelValue":l[12]||(l[12]=a=>e.valid=a),"lazy-validation":"",onSubmit:H(o.save,["prevent"])},{default:i(()=>[t(V,null,{default:i(()=>[t(b,null,{default:i(()=>[t(d,{cols:"12",md:"6"},{default:i(()=>[t(_,{modelValue:e.editedItem.option_number,"onUpdate:modelValue":l[6]||(l[6]=a=>e.editedItem.option_number=a),label:"Option Number",variant:"outlined",rules:[a=>!!a||"Option number is required",a=>/^\d+$/.test(a)||"Must be a number"],hint:"The number callers will press (1-9)","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),t(d,{cols:"12",md:"6"},{default:i(()=>[t(I,{modelValue:e.editedItem.status,"onUpdate:modelValue":l[7]||(l[7]=a=>e.editedItem.status=a),items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],"item-title":"title","item-value":"value",label:"Status",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),t(d,{cols:"12"},{default:i(()=>[t(_,{modelValue:e.editedItem.description,"onUpdate:modelValue":l[8]||(l[8]=a=>e.editedItem.description=a),label:"Description",variant:"outlined",rules:[a=>!!a||"Description is required"],hint:"Description of this menu option","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),t(d,{cols:"12",md:"6"},{default:i(()=>[R(t(_,{modelValue:e.editedItem.phone_number,"onUpdate:modelValue":l[9]||(l[9]=a=>e.editedItem.phone_number=a),label:"Virtual Number",variant:"outlined",rules:[a=>!!a||"Virtual number is required",o.validatePhoneNumber],hint:"The virtual phone number","persistent-hint":"",required:""},null,8,["modelValue","rules"]),[[A,e.phoneNumberMask]])]),_:1}),t(d,{cols:"12",md:"6"},{default:i(()=>[R(t(_,{modelValue:e.editedItem.forward_number,"onUpdate:modelValue":l[10]||(l[10]=a=>e.editedItem.forward_number=a),label:"Forward Number",variant:"outlined",rules:[a=>!!a||"Forward number is required",o.validatePhoneNumber],hint:"Number to forward to when selected","persistent-hint":"",required:""},null,8,["modelValue","rules"]),[[A,e.phoneNumberMask]])]),_:1}),t(d,{cols:"12"},{default:i(()=>[t(B,{modelValue:e.editedItem.notes,"onUpdate:modelValue":l[11]||(l[11]=a=>e.editedItem.notes=a),label:"Notes (Optional)",variant:"outlined",hint:"Additional notes about this IVR option","persistent-hint":"",rows:"3","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1}),t(j),t(N,{class:"pa-4"},{default:i(()=>[t(c,{variant:"outlined",color:"grey",onClick:o.close},{default:i(()=>[n("Cancel")]),_:1},8,["onClick"]),t(k),t(c,{variant:"elevated",color:"primary",onClick:o.save,disabled:!e.valid,loading:e.saving},{default:i(()=>[n(" Save ")]),_:1},8,["onClick","disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(x,{modelValue:e.deleteDialog,"onUpdate:modelValue":l[15]||(l[15]=a=>e.deleteDialog=a),"max-width":"500px"},{default:i(()=>[t(D,null,{default:i(()=>[t(S,{class:"text-h5 bg-error text-white pa-4"},{default:i(()=>[n(" Confirm Delete ")]),_:1}),t(F,{class:"pa-4 pt-6"},{default:i(()=>{var a,p;return[n(" Are you sure you want to delete this IVR option? "),u("div",ne,[u("strong",null,"Option "+h((a=e.deleteItem)==null?void 0:a.option_number)+":",1),n(" "+h((p=e.deleteItem)==null?void 0:p.description),1)]),re]}),_:1}),t(N,{class:"pa-4"},{default:i(()=>[t(c,{variant:"text",color:"grey",onClick:l[14]||(l[14]=a=>e.deleteDialog=!1)},{default:i(()=>[n("Cancel")]),_:1}),t(k),t(c,{variant:"elevated",color:"error",onClick:o.deleteIvrOption,loading:e.deleting},{default:i(()=>[n(" Delete ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const pe=W(X,[["render",de],["__scopeId","data-v-69b2cb3d"]]);export{pe as default};
